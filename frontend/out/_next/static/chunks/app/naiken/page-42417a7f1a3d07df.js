(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[81],{6092:(e,r,s)=>{Promise.resolve().then(s.bind(s,6154))},6154:(e,r,s)=>{"use strict";s.r(r),s.d(r,{default:()=>l});var i=s(5155),t=s(2115),a=s(6519);let n=e=>{let{isOpen:r,onClose:s,onConfirm:t,formData:a}=e;return r&&a?(0,i.jsx)("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50",children:(0,i.jsxs)("div",{className:"bg-white p-6 rounded-lg max-w-2xl w-full max-h-[90vh] overflow-y-auto",children:[(0,i.jsx)("h2",{className:"text-xl font-bold mb-4",children:"入力内容の確認"}),(0,i.jsxs)("div",{className:"space-y-4",children:[(0,i.jsxs)("div",{children:[(0,i.jsx)("h3",{className:"font-bold",children:"内見希望者情報"}),(0,i.jsxs)("div",{className:"grid grid-cols-2 gap-2",children:[(0,i.jsx)("div",{children:"氏名："}),(0,i.jsx)("div",{children:a.name}),(0,i.jsx)("div",{children:"電話番号："}),(0,i.jsx)("div",{children:a.phone}),(0,i.jsx)("div",{children:"メールアドレス："}),(0,i.jsx)("div",{children:a.email})]})]}),(0,i.jsxs)("div",{children:[(0,i.jsx)("h3",{className:"font-bold",children:"内見希望物件"}),(0,i.jsxs)("div",{className:"grid grid-cols-2 gap-2",children:[(0,i.jsx)("div",{children:"物件："}),(0,i.jsxs)("div",{children:[a.property.no," ",a.property.address]}),(0,i.jsx)("div",{children:"種別："}),(0,i.jsx)("div",{children:a.property.type})]})]}),(0,i.jsxs)("div",{children:[(0,i.jsx)("h3",{className:"font-bold",children:"内見希望日"}),(0,i.jsxs)("div",{className:"grid grid-cols-2 gap-2",children:[(0,i.jsx)("div",{children:"第1希望日："}),(0,i.jsxs)("div",{children:[a.date1," ",a.time1]}),(0,i.jsx)("div",{children:"第2希望日："}),(0,i.jsxs)("div",{children:[a.date2," ",a.time2]})]})]}),(0,i.jsxs)("div",{children:[(0,i.jsx)("h3",{className:"font-bold",children:"プライバシーポリシー同意"}),(0,i.jsx)("div",{children:a.privacy?"同意する":"同意しない"})]}),(0,i.jsxs)("div",{children:[(0,i.jsx)("h3",{className:"font-bold",children:"添付ファイル"}),(0,i.jsx)("div",{children:a.imgFile?"string"==typeof a.imgFile?a.imgFile:a.imgFile.name:"未添付"})]})]}),(0,i.jsxs)("div",{className:"mt-6 flex justify-end space-x-4",children:[(0,i.jsx)("button",{onClick:s,className:"px-4 py-2 border rounded hover:bg-gray-100",children:"修正する"}),(0,i.jsx)("button",{onClick:t,className:"px-4 py-2 bg-blue-500 text-white rounded hover:bg-blue-600",children:"送信する"})]})]})}):null};function l(){let[e,r]=(0,t.useState)([]),[s,l]=(0,t.useState)(""),[d,c]=(0,t.useState)([]),[o,m]=(0,t.useState)(null),[p,h]=(0,t.useState)(null),[u,x]=(0,t.useState)(!1),j=(0,t.useRef)(null);(0,t.useEffect)(()=>{(async()=>{let e=await a.p.getInstance().fetchPropertiesNaiken();r(e),c(e)})()},[]),(0,t.useEffect)(()=>{c(e.filter(e=>e.no.includes(s)||e.address.includes(s)))},[s,e]);let y=async()=>{if(p)try{let r=await a.p.getInstance().sendNaikenFormData(p);if(console.log("API Response:",r),"success"===r.status){var e;alert("送信に成功しました"),x(!1),null==(e=j.current)||e.reset(),m(null),h(null)}else alert("送信に失敗しました。\nしばらく経ってから再度お試しください。\nこのメッセージが繰り返し出る場合は、お手数ですが弊社に直接お問い合わせください。\n\n"+(r.message||"詳細不明"))}catch(e){console.error("送信エラー:",e),alert("送信に失敗しました。\nしばらく経ってから再度お試しください。\nこのメッセージが繰り返し出る場合は、お手数ですが弊社に直接お問い合わせください。\n\n"+e)}};return(0,i.jsxs)("div",{className:"m-4 p-4 bg-white rounded-lg shadow-md",children:[(0,i.jsx)("h1",{children:"内見希望受付フォーム"}),(0,i.jsxs)("p",{className:"text-sm text-red-500 mb-4",children:["以下の項目を入力してご希望日をお送りください。",(0,i.jsx)("br",{}),"日程が確定しましたら、担当よりご連絡いたします。"]}),(0,i.jsxs)("form",{ref:j,onSubmit:e=>{var r,s,i,t,a,n,l,d,c,m,p,u,j,y,g;e.preventDefault();let v=new FormData(e.currentTarget),f={name:null!=(c=null==(r=v.get("name"))?void 0:r.toString())?c:"",phone:null!=(m=null==(s=v.get("phone"))?void 0:s.toString())?m:"",email:null!=(p=null==(i=v.get("email"))?void 0:i.toString())?p:"",date1:null!=(u=null==(t=v.get("date1"))?void 0:t.toString())?u:"",time1:null!=(j=null==(a=v.get("time1"))?void 0:a.toString())?j:"",date2:null!=(y=null==(n=v.get("date2"))?void 0:n.toString())?y:"",time2:null!=(g=null==(l=v.get("time2"))?void 0:l.toString())?g:"",imgFile:v.get("imgFile"),privacy:(null==(d=v.get("privacy"))?void 0:d.toString())==="on",property:o};console.log(f),h(f),x(!0)},children:[(0,i.jsxs)("div",{className:"form-group",children:[(0,i.jsxs)("label",{htmlFor:"propertySearch",children:["内見希望物件名",(0,i.jsx)("span",{className:"required",children:"*"})]}),(0,i.jsxs)("div",{className:"relative",children:[(0,i.jsx)("input",{type:"text",id:"propertySearch",value:s,onChange:e=>l(e.target.value),placeholder:"物件番号または住所で検索（部分一致可）",className:"w-full border rounded p-2"}),(0,i.jsxs)("select",{id:"propertySelect",name:"propertyName",onChange:r=>{var s;return m(null!=(s=e.find(e=>e.no+" "+e.address===r.target.value))?s:null)},defaultValue:"",required:!0,className:"w-full border rounded mt-2 p-2",children:[(0,i.jsx)("option",{value:"",disabled:!0,children:"-- 物件を選択してください --"}),d.map((e,r)=>{let s="".concat(e.no," ").concat(e.address);return(0,i.jsxs)("option",{value:s,children:[e.no," ",e.address]},"property-".concat(r,"-").concat(e.no))})]})]})]}),(0,i.jsxs)("div",{className:"form-group",children:[(0,i.jsxs)("label",{htmlFor:"name",children:["氏名",(0,i.jsx)("span",{className:"required",children:"*"})]}),(0,i.jsx)("input",{type:"text",id:"name",name:"name",required:!0})]}),(0,i.jsxs)("div",{className:"form-group",children:[(0,i.jsxs)("label",{htmlFor:"phone",children:["電話番号",(0,i.jsx)("span",{className:"required",children:"*"})]}),(0,i.jsx)("input",{type:"tel",id:"phone",name:"phone",required:!0})]}),(0,i.jsxs)("div",{className:"form-group",children:[(0,i.jsxs)("label",{htmlFor:"email",children:["メールアドレス",(0,i.jsx)("span",{className:"required",children:"*"})]}),(0,i.jsx)("input",{type:"email",id:"email",name:"email",required:!0})]}),(0,i.jsxs)("div",{className:"flex",children:[(0,i.jsxs)("div",{className:"form-group mr-4",children:[(0,i.jsxs)("label",{htmlFor:"date1",children:["内見希望日①",(0,i.jsx)("span",{className:"required",children:"*"})]}),(0,i.jsx)("input",{type:"date",id:"date1",name:"date1",required:!0})]}),(0,i.jsxs)("div",{className:"form-group",children:[(0,i.jsxs)("label",{htmlFor:"time1",children:["目安時間帯",(0,i.jsx)("span",{className:"required",children:"*"})]}),(0,i.jsx)("input",{type:"time",id:"time1",name:"time1",required:!0})]})]}),(0,i.jsxs)("div",{className:"flex",children:[(0,i.jsxs)("div",{className:"form-group mr-4",children:[(0,i.jsxs)("label",{htmlFor:"date2",children:["内見希望日②",(0,i.jsx)("span",{className:"required",children:"*"})]}),(0,i.jsx)("input",{type:"date",id:"date2",name:"date2",required:!0})]}),(0,i.jsxs)("div",{className:"form-group",children:[(0,i.jsxs)("label",{htmlFor:"time2",children:["目安時間帯",(0,i.jsx)("span",{className:"required",children:"*"})]}),(0,i.jsx)("input",{type:"time",id:"time2",name:"time2",required:!0})]})]}),(0,i.jsxs)("div",{className:"form-group",children:[(0,i.jsxs)("label",{htmlFor:"imgFile",children:["身分証 or 名刺を画像ファイルでアップロードしてください",(0,i.jsx)("span",{className:"required",children:"*"})]}),(0,i.jsx)("input",{type:"file",id:"imgFile",name:"imgFile",required:!0})]}),(0,i.jsxs)("div",{className:"form-group flex mb-4",children:[(0,i.jsx)("input",{type:"checkbox",id:"privacy",name:"privacy",className:"mr-2",required:!0}),(0,i.jsxs)("label",{htmlFor:"privacy",children:["プライバシーポリシーに同意します",(0,i.jsx)("span",{className:"required",children:"*"})]})]}),(0,i.jsx)("button",{type:"submit",id:"submitBtn",children:"送信する"})]}),(0,i.jsx)(n,{isOpen:u,onClose:()=>x(!1),onConfirm:y,formData:p})]})}},6519:(e,r,s)=>{"use strict";s.d(r,{p:()=>i});class i{static getInstance(){return i.instance||(i.instance=new i),i.instance}async fetchProperties(){try{let e=this.API_URL+"/fetch",r=await fetch(e);return(await r.json()).properties.filter(e=>e.no&&""!==e.no.trim())}catch(e){return console.error("物件データの取得に失敗しました:",e),[]}}async fetchPropertiesNaiken(){try{let e=this.API_URL+"/fetch_naiken",r=await fetch(e);return(await r.json()).properties.filter(e=>e.no&&""!==e.no.trim())}catch(e){return console.error("物件データの取得に失敗しました:",e),[]}}async sendKaitsukeFormData(e){try{let r={lastName:e.lastName,firstName:e.firstName,companyName:e.companyName,email:e.email,phone:e.phone,address:e.address,media:e.media,agentName:e.agentName,offerPrice:e.offerPrice,deposit:e.deposit,loan:e.loan,conditions:e.conditions,propertyNo:e.property.no,propertyAddress:e.property.address,propertyType:e.property.type,propertyPrice:e.property.price},s=this.API_URL+"/send_kaitsuke",i=await fetch(s,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(r)});return await i.json()}catch(e){return console.error("フォームデータの送信に失敗しました:",e),{status:"error",message:"フォームデータの送信に失敗しました"}}}async sendNaikenFormData(e){try{let r={name:e.name,phone:e.phone,email:e.email,date1:e.date1,time1:e.time1,date2:e.date2,time2:e.time2,imgFile:e.imgFile,privacy:e.privacy,propertyNo:e.property.no,propertyAddress:e.property.address,propertyType:e.property.type,propertyPrice:e.property.price},s=this.API_URL+"/send_naiken",i=await fetch(s,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(r)});return await i.json()}catch(e){return console.error("フォームデータの送信に失敗しました:",e),{status:"error",message:"フォームデータの送信に失敗しました"}}}constructor(){this.API_URL="https://techpro-form-api-236032490225.asia-northeast1.run.app"}}}},e=>{var r=r=>e(e.s=r);e.O(0,[441,684,358],()=>r(6092)),_N_E=e.O()}]);